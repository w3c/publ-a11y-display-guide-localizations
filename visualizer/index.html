<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
    <head>
        <meta charset="utf-8" />
        <title>Display guide localization strings visualiser</title>
   
    </head>
    <body>
        <section id="info">
        <h2>How to use this page</h2>
            <p>
                This page is part of the <a href="https://w3c.github.io/publ-a11y/a11y-meta-display-guide/2.0/guidelines/index.html">Accessibility Metadata Display Guide for Digital Publications 2.0</a> and complementary with the each of the <a href="https://w3c.github.io/publ-a11y/a11y-meta-display-guide/2.0/guidelines/index.html#techniques">techniques documents</a>. 
            </p>
            <p>This page includes a selector that affects the content being presented.</p>
    </section>
        <section>
            <h2>Localization string selector</h2>
        <p>
            The selector allows to choose a string that will be displayed in the following sections, changing the content and language of them.
        </p> 
        <select id="json-source-select">
            <option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/en-US/display_guide_vocabulary_w3c.json">W3C Canonical US English</option>
            <option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/ar-SA/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Arabic</option>
display_guide_vocabulary_vitalsource.json
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/bg-BG/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Bulgarian</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/ca-ES/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Catalan</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/cs-CZ/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Czech</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/cy-GB/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Welsh</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/da-DK/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Danish</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/de-DE/display_guide_vocabulary_vitalsource.json">Vital Source Canonical German</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/el-GR/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Greek</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/en-GB/display_guide_vocabulary_vitalsource.json">Vital Source Canonical UK English</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/es-ES/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Spanish (Spain)</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/es-ES/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Spanish (Mexico)</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/fi-FI/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Finnish</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/fr-CA/display_guide_vocabulary_vitalsource.json">Vital Source Canonical French (Canada)</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/fr-FR/display_guide_vocabulary_edrlab.json">EDRLab Canonical French (France)</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/fr-FR/display_guide_vocabulary_vitalsource.json">Vital Source Canonical French (France)</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/ga-IE/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Irish</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/he-IL/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Hebrew</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/hi-IN/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Hindi</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/hu-HU/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Hungarian</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/id-ID/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Indonesian</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/is-IS/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Icelandic</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/it-IT/display_guide_vocabulary_fondazioneLIA.json">Fondazione Lia Canonical Italian</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/it-IT/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Italian</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/ja-JP/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Japanese</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/ko-KR/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Korean</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/nb-NO/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Norwegian</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/nl-NL/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Dutch</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/pl-PL/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Polish</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/pt-BR/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Portuguese (Brazil)</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/pt-PT/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Portuguese (Portugal)</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/ro-RO/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Romanian</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/ru-RU/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Russian</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/sv-SE/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Swedish</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/th-TH/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Thai</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/tl-PH/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Tagalog</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/tr-TR/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Turkish</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/vi-VN/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Vietnamese</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/zh-CN/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Chinese (China)</option>
<option value="https://w3c.github.io/publ-a11y-display-guide-localizations/lang/zh-TW/display_guide_vocabulary_vitalsource.json">Vital Source Canonical Chinese (Taiwan)</option>
        </select>
    </section>
        <section id="tables-container"></section>

        </section>

        <script>
            // Function to fetch JSON data
async function fetchJsonData(url) {
    try {
        const response = await fetch(url);
        if (!response.ok) {
            throw new Error(`HTTP error status: ${response.status}`);
        }
        return await response.json();
    } catch (error) {
        console.error('Error fetching JSON:', error);
    }
}

// Function to create lists and tables for each key-value pair
function createListsAndTables(data, parentContainer) {
        // Set the lang attribute based on the language key
        const language = data.metadata.language;
        parentContainer.setAttribute('lang', language);
    Object.keys(data).forEach(key => {
        if (key === 'metadata') {
            const metadataList = document.createElement('ul');
            Object.keys(data[key]).forEach(subKey => {
                const listItem = document.createElement('li');
                const spanKey = document.createElement('span');
                spanKey.className = 'inline-list-item';
                spanKey.textContent = subKey;
                const spanValue = document.createElement('span');
                spanValue.textContent = data[key][subKey];
                listItem.appendChild(spanKey);
                listItem.appendChild(spanValue);
                metadataList.appendChild(listItem);
            });
            parentContainer.appendChild(document.createElement('h2')).textContent = 'Information about this localization string';
            parentContainer.appendChild(metadataList);
        } else if (typeof data[key] === 'object') {
            // Find the title key within the object
            const titleKey = Object.keys(data[key]).find(subKey => subKey.endsWith('-title'));
            const titleValue = titleKey ? data[key][titleKey] : key;

            // Display the title
            const tableHeading = document.createElement('h2');
            tableHeading.innerHTML = `<span class="key">${key}</span>: <span class="value">${titleValue}</span>`;
            parentContainer.appendChild(tableHeading);

            // Check if there are any descriptive keys
            const descriptiveKeys = Object.keys(data[key]).filter(subKey => typeof data[key][subKey] === 'object' && data[key][subKey].descriptive);

            if (descriptiveKeys.length > 0) {
                // Create table if descriptive keys are present
                const table = document.createElement('table');
                const tableHeader = document.createElement('thead');
                const tableBody = document.createElement('tbody');

                // Create table header
                const headerRow = document.createElement('tr');
                headerRow.innerHTML = `
                    <th>Key ID</th>
                    <th>Descriptive sentence</th>
                    <th>Compact sentence</th>
                `;
                tableHeader.appendChild(headerRow);

                // Create table body
                descriptiveKeys.forEach(subKey => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${subKey}</td>
                        <td>${data[key][subKey].descriptive}</td>
                        <td>${data[key][subKey].compact}</td>
                    `;
                    tableBody.appendChild(row);
                });

                // Assemble the table
                table.appendChild(tableHeader);
                table.appendChild(tableBody);

                parentContainer.appendChild(table);
            } else {
                // If no descriptive keys are present, display a list of all subkeys
                const subkeysList = document.createElement('ul');
                Object.keys(data[key]).forEach(subKey => {
                    if (subKey !== titleKey) { // Exclude the title key if it exists
                        const listItem = document.createElement('li');
                        const keySpan = document.createElement('span');
                        keySpan.className = 'key';
                        keySpan.textContent = subKey;
                        const valueSpan = document.createElement('span');
                        valueSpan.className = 'value';
                        valueSpan.textContent = data[key][subKey];
                        listItem.innerHTML = `<span class="key">${subKey}</span>: <span class="value">${data[key][subKey]}</span>`;
                        subkeysList.appendChild(listItem);
                    }
                });
                parentContainer.appendChild(subkeysList);
            }

            // Handle subsets of additional-accessibility-information
            if (key === 'additional-accessibility-information') {
                Object.keys(data[key]).forEach(subSubsetKey => {
                    if (typeof data[key][subSubsetKey] === 'object' && subSubsetKey.endsWith('-title')) {
                        const subsetTitle = data[key][subSubsetKey];
                        const subsetHeading = document.createElement('h3');
                        subsetHeading.textContent = subsetTitle;
                        parentContainer.appendChild(subsetHeading);

                        const subsetDescriptiveKeys = Object.keys(data[key]).filter(subKey => subKey.startsWith(subSubsetKey.replace('-title', '')) && typeof data[key][subKey] === 'object' && data[key][subKey].descriptive);
                        if (subsetDescriptiveKeys.length > 0) {
                            const subsetTable = document.createElement('table');
                            const subsetTableHeader = document.createElement('thead');
                            const subsetTableBody = document.createElement('tbody');

                            // Create table header
                            const subsetHeaderRow = document.createElement('tr');
                            subsetHeaderRow.innerHTML = `
                                <th>Key ID</th>
                                <th>Descriptive sentence</th>
                                <th>Compact sentence</th>
                            `;
                            subsetTableHeader.appendChild(subsetHeaderRow);

                            // Create table body
                            subsetDescriptiveKeys.forEach(subKey => {
                                const row = document.createElement('tr');
                                row.innerHTML = `
                                    <td>${subKey}</td>
                                    <td>${data[key][subKey].descriptive}</td>
                                    <td>${data[key][subKey].compact}</td>
                                `;
                                subsetTableBody.appendChild(row);
                            });

                            // Assemble the table
                            subsetTable.appendChild(subsetTableHeader);
                            subsetTable.appendChild(subsetTableBody);

                            parentContainer.appendChild(subsetTable);
                        } else {
                            // If no descriptive keys are present in the subset, display a list of all subkeys
                            const subsetSubkeysList = document.createElement('ul');
                            Object.keys(data[key]).forEach(subKey => {
                                if (subKey.startsWith(subSubsetKey.replace('-title', '')) && subKey !== subSubsetKey) {
                                    const listItem = document.createElement('li');
                                    const keySpan = document.createElement('span');
                                    keySpan.className = 'key';
                                    keySpan.textContent = subKey;
                                    const valueSpan = document.createElement('span');
                                    valueSpan.className = 'value';
                                    valueSpan.textContent = data[key][subKey];
                                    listItem.innerHTML = `<span class="key">${subKey}</span>: <span class="value">${data[key][subKey]}</span>`;
                                    subsetSubkeysList.appendChild(listItem);
                                }
                            });
                            parentContainer.appendChild(subsetSubkeysList);
                        }
                    }
                });
            }
        }
    });
}

// Function to initialize the list and table creation
function initializeListAndTableCreation(data) {
    const tablesContainer = document.getElementById('tables-container');
    tablesContainer.innerHTML = ''; // Clear the container before populating it

    createListsAndTables(data, tablesContainer);
}

// Event listener for select change
document.getElementById('json-source-select').addEventListener('change', async function() {
    const selectedUrl = this.value;
    fetchJsonData(selectedUrl)
        .then(data => initializeListAndTableCreation(data))
        .catch(error => console.error('Error creating lists and tables:', error));
});

// Load initial JSON data and create lists and tables
const initialUrl = document.getElementById('json-source-select').value;
fetchJsonData(initialUrl)
    .then(data => initializeListAndTableCreation(data))
    .catch(error => console.error('Error creating lists and tables:', error));
        </script>
    </body>
</html>
